PUSH BP
MOV BP, SP
MOV R1, BP
MOV R2, 6
SUB R1, R2
MOV R1, [R1]
MOV R2, "Alloc"
EQ R2, R1
JNZ  R2, 50
MOV R2, "Free"
EQ R2, R1
JNZ  R2, 66
MOV R2, "Heapset"
EQ R2, R1
JNZ  R2, 82
MOV R2, "Write"
EQ R2, R1
JNZ  R2, 102
MOV R2, "Read"
EQ R2, R1
JNZ  R2, 106
MOV R2, "Exit"
EQ R2, R1
JNZ  R2, 110
JMP 186
MOV R0, [1024]
MOV R1, [R0]
MOV [1024], R1
MOV R2, BP
MOV R3, 2
SUB R2, R3
MOV [R2], R0
JMP 186
MOV R0, BP
MOV R1, 5
SUB R0, R1
MOV R1, [R0]
MOV R2, [1024]
MOV [R1], R2
MOV [1024], R1
JMP 186
MOV R1, 2040
MOV R2, -1
MOV R0, 1024
GT R0, R1
JNZ  R0, 100
MOV [R1], R2
MOV R2, R1
SUB R1, 8
JMP 86
JMP 186
MOV R7, 5
JMP 112
MOV R7, 7
JMP 112
MOV R7, 10
MOV R11, BP
MOV R12, 5
SUB R11, R12
MOV R12, [R11]
ADD R11, 1
MOV R13, [R11]
ADD R11, 1
MOV R14, [R11]
PUSH R7
PUSH R12
PUSH R13
PUSH R14
PUSH R7
MOV R2, "Write"
EQ R2, R1
JNZ  R2, 158
MOV R2, "Read"
EQ R2, R1
JNZ  R2, 162
MOV R2, "Exit"
EQ R2, R1
JNZ  R2, 166
JMP 186
INT 7
JMP 168
INT 6
JMP 168
INT 10
POP R1
POP R2
POP R2
POP R2
POP R2
MOV R2, BP
MOV R3, 2
SUB R2, R3
MOV [R2], R1
POP BP
RET
